---
import Head from '../components/Head.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import SchemaOrg from '../components/SchemaOrg.astro';
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  image?: string;
  type?: 'website' | 'article';
  publishedTime?: string;
  modifiedTime?: string;
  tags?: string[];
  schemaType?: 'home' | 'article';
  wordCount?: number;
  parentTitle?: string;
  parentUrl?: string;
}

const {
  title,
  description,
  image,
  type = 'website',
  publishedTime,
  modifiedTime,
  tags,
  schemaType = 'home',
  wordCount,
  parentTitle,
  parentUrl,
} = Astro.props;
---

<!doctype html>
<html lang="ja">
  <head>
    <script is:inline>
      (function() {
        var stored = localStorage.getItem('theme');
        var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (stored === 'dark' || (!stored && prefersDark)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script>
    <Head
      title={title}
      description={description}
      image={image}
      type={type}
      publishedTime={publishedTime}
      modifiedTime={modifiedTime}
      tags={tags}
    />
    <SchemaOrg
      type={schemaType}
      title={title}
      description={description}
      image={image}
      datePublished={publishedTime}
      dateModified={modifiedTime}
      tags={tags}
      wordCount={wordCount}
      parentTitle={parentTitle}
      parentUrl={parentUrl}
    />
  </head>
  <body>
    <a class="skip-link" href="#content">Skip to content</a>
    <Header />
    <main id="content">
      <slot />
    </main>
    <Footer />
    <script is:inline type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
  </body>
</html>
