---
title: UbuntuとmacOSのdotfilesをまとめた
template: "post"
date: "2021-05-26"
draft: false
slug: "dotfiles"
category: "tech"
description: "本末転倒になりがちなdotfiles"
tags:
- "tech"
- "dotfiles"
- "ubuntu"
- "macos"
---

## *dotfiles*の管理がめんどくさい

私は現在(2020/05/25)、いくつか手持ちにパソコンがあります。しかし、*OS*がバラバラであり*dotfiles*をそれぞれの*OS*に合わせて管理するのが非常に面倒でした。

そのため、このたび*macOS*と*Ubuntu*用に合った*dotfiles*を合体させ新しい*dotfiles*を作成させました。

### ところで*dotfiles*とは？

*dotfiles*とはパソコンの設定ファイルをまとめたものです。慣習的にそのように呼んでいるだけで、別名があるのかもしれませんが、[非公式なページ](https://dotfiles.github.io/)も存在するので大体このように読んで齟齬は発生しないと思います。パソコンを買い換える際にローカルの作業環境をできるだけどこでも同じにするという目的で作られます。

## *Ubuntu*と*macOS*の共通化をする際に意識した点

できるだけ、同じソフトをインストールする際は共通の書き方ができるように意識しました。そのため、*apt*や*brew*ではなく、*nix*という*Unix*向けのパッケージ管理ソフトを使いました。*brew*で統一をしなかった点は以下の通りとなっています。

*Ubuntu*用に*brewfile*･*apt*のインストールファイル、*macOS*用に*brewfile*を書く労力と*Ubuntu*用に*apt*のインストールファイル、*macOS*用に*brewfile*、共通の*nix*ファイルを書く労力はほぼ同じはずですが、前者の場合は依存関係などに悩まされる可能性があり、後述するように再現性のある*nix*を使うことで同じ労力でより巻き戻しのコストが掛からないよう環境にしました。

### ところで*nix*とは？

[HERP](https://herp.co.jp/)という会社で少しバイトをしていたときに知りました。どのようなソフトかは[公式ホームページ](https://nixos.wiki/wiki/Nix)をお読みください...というのは流石に雑すぎるので多少使っている感想も含めて話します。

*nix*とは再現性のあるパッケージ管理ソフトです。また、宣言的に環境を管理することができ、*Linux*系の*OS*、*macOS*ならば共通して使えるので、今後もし*Arch Linux*など別の*OS*を使おうと思った際も楽に環境が構築できるだろうということで導入しました。他には[cachix](https://cachix.org/)というソフトを使えば、バイナリのままインストールできるという利点があります。また、アンインストールも楽(`/nix`を消すだけ)で、ロールバックもできるので、やめようと思ったときに簡単にやめられ、失敗しても焦らないという点も良いです。このように色々と利点があるソフトなので導入する価値はあるでしょう。

...というの建前で、本当に導入をしたのは新しい技術を導入したかったという｢好きだから好き｣くらいの理由です。結果的に便利だったので、使い続けることになりました。ありがとうHERP！(バイトをやめたことを後悔している顔)

### ディレクトリ構成

*dotfiles*のディレクトリ構成は以下の通りです。`bin`というディレクトリの中にインストールファイルなどが入っていおり、`dotfiles`という直下のフォルダがホームディレクトリにリンクされます。`dotfiles/.config`内に各種設定用ディレクトリがあります。

[XDG Base Directory Specification](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html)に従っており、ディレクトリが整理されているので、ファイルが散らばっておらず修正が加えやすくなっています。

```sh
.
├── bin
└── dotfiles
   └── .config
      ├── alacritty
      ├── cargo
      ├── doom
      ├── git
      │  └── templates
      ├── karabiner
      ├── nixpkgs
      │  └── overlays
      ├── nvim
      ├── tmux
      └── zsh
```

### 共通化して良かった点と困った点

良かった点は共通化したことでメンテナンスが楽になりました。また、*nix*を導入したことで今まではビルドエラーになっていたものがそのまますんなりとインストールできるようになり快適です。

困った点は何故か*GUI*を使うアプリを*nix*でインストールすると、*Ubuntu*で*gtk*に関するエラーが出る点です。未だにこれが解決しないので、*GUI*アプリは*nix*ではインストールしていません。これは調査中です。

## 最後に

*dotfiles*の管理ばかりしていて、他のソフトウェアを書かないと本末転倒という意見もあります。
