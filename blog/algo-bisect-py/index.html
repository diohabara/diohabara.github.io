<!DOCTYPE html><html lang="ja"> <head><script>
      (function() {
        var stored = localStorage.getItem('theme');
        var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (stored === 'dark' || (!stored && prefersDark)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Pythonã®bisectã«ã¤ã„ã¦ | barabara diary</title><meta name="description" content="MAKE THE WORLD FUN AGAIN"><meta name="keywords" content="blog, diohabara, memo, python, algorithm, bisect"><meta property="og:url" content="https://diohabara.github.io/blog/algo-bisect-py/"><meta property="og:type" content="article"><meta property="og:title" content="Pythonã®bisectã«ã¤ã„ã¦ | barabara diary"><meta property="og:description" content="MAKE THE WORLD FUN AGAIN"><meta property="og:image" content="https://diohabara.github.io/img/avatar.jpg"><meta property="article:published_time" content="2026-01-18T08:17:17.000Z"><meta property="article:modified_time" content="2026-01-18T08:17:17.000Z"><meta property="article:author" content="diohabara"><meta property="article:tag" content="memo"><meta property="article:tag" content="python"><meta property="article:tag" content="algorithm"><meta property="article:tag" content="bisect"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Pythonã®bisectã«ã¤ã„ã¦ | barabara diary"><meta name="twitter:description" content="MAKE THE WORLD FUN AGAIN"><meta name="twitter:site" content="@diohabara"><meta name="twitter:creator" content="@diohabara"><meta name="twitter:image" content="https://diohabara.github.io/img/avatar.jpg"><link rel="canonical" href="https://diohabara.github.io/blog/algo-bisect-py/"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" title="barabara diary" href="/rss.xml"><script async src="https://www.googletagmanager.com/gtag/js?id=G-JC4F65F0RT"></script><script>(function(){const gaId = "G-JC4F65F0RT";

      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pythonã®bisectã«ã¤ã„ã¦","name":"Pythonã®bisectã«ã¤ã„ã¦","url":"https://diohabara.github.io/blog/algo-bisect-py/","description":"MAKE THE WORLD FUN AGAIN","keywords":"memo, python, algorithm, bisect","wordCount":749,"datePublished":"2026-01-18T08:17:17.000Z","dateModified":"2026-01-18T08:17:17.000Z","author":{"@type":"Person","name":"diohabara","url":"https://diohabara.github.io/"},"publisher":{"@type":"Person","name":"diohabara","logo":{"@type":"ImageObject","url":"https://diohabara.github.io/img/avatar.jpg"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diohabara.github.io/blog/algo-bisect-py/"},"inLanguage":"ja"}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://diohabara.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://diohabara.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Pythonã®bisectã«ã¤ã„ã¦","item":"https://diohabara.github.io/blog/algo-bisect-py/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"diohabara","url":"https://diohabara.github.io/","description":"MAKE THE WORLD FUN AGAIN","sameAs":["https://twitter.com/diohabara"]}</script><link rel="stylesheet" href="/_astro/_slug_.BHQlRgxU.css"></head> <body> <a class="skip-link" href="#content">Skip to content</a> <header class="site-header"> <h1><a href="/">barabara diary</a></h1> <nav class="site-nav"> <a href="/blog/"> Blog </a><a href="/compensation/"> Compensation </a><a href="/tags/"> Tags </a><a href="https://github.com/diohabara/" target="_blank" rel="noopener noreferrer"> GitHub </a><a href="/search/"> Search </a><a href="/rss.xml"> RSS </a> <button class="dark-toggle" id="dark-toggle" aria-label="Toggle dark mode"> <span id="theme-icon">ğŸŒ™</span> </button> </nav> </header> <script type="module">function s(){const n=document.getElementById("dark-toggle"),t=document.getElementById("theme-icon");if(!n||!t)return;const e=document.documentElement,a=e.classList.contains("dark");t.textContent=a?"â˜€ï¸":"ğŸŒ™",requestAnimationFrame(()=>{e.classList.add("transitions-ready")}),n.addEventListener("click",()=>{const o=e.classList.toggle("dark");localStorage.setItem("theme",o?"dark":"light"),t.textContent=o?"â˜€ï¸":"ğŸŒ™"})}s();document.addEventListener("astro:after-swap",s);</script> <main id="content">  <article class="has-sidenotes"> <header class="article-header"> <h1>Pythonã®bisectã«ã¤ã„ã¦</h1> <div class="post-meta"> <time datetime="2026-01-18T08:17:17.000Z">2026/01/18</time> <span class="post-tags"> <a class="tag" href="/tags/memo/">memo</a><a class="tag" href="/tags/python/">python</a><a class="tag" href="/tags/algorithm/">algorithm</a><a class="tag" href="/tags/bisect/">bisect</a> </span> </div> </header> <nav class="toc"> <details open> <summary>ç›®æ¬¡</summary> <ul> <li class> <a href="#tldr">TL;DR</a> </li><li class> <a href="#bisectã¨ã¯">bisectã¨ã¯</a> </li><li class> <a href="#ä½¿ã„æ–¹ã®åŸºæœ¬">ä½¿ã„æ–¹ã®åŸºæœ¬</a> </li><li class> <a href="#ã‚³ãƒ¼ãƒŠãƒ¼ã‚±ãƒ¼ã‚¹-æœ€å°ã‚ˆã‚Šå°ã•ã„æœ€å¤§ã‚ˆã‚Šå¤§ãã„">ã‚³ãƒ¼ãƒŠãƒ¼ã‚±ãƒ¼ã‚¹: æœ€å°ã‚ˆã‚Šå°ã•ã„/æœ€å¤§ã‚ˆã‚Šå¤§ãã„</a> </li><li class> <a href="#å…·ä½“ä¾‹1-å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’é«˜é€Ÿã«èª¿ã¹ã‚‹">å…·ä½“ä¾‹1: å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’é«˜é€Ÿã«èª¿ã¹ã‚‹</a> </li><li class> <a href="#å…·ä½“ä¾‹2-ã‚¹ã‚³ã‚¢ã®ãƒ©ãƒ³ã‚¯åˆ†ã‘">å…·ä½“ä¾‹2: ã‚¹ã‚³ã‚¢ã®ãƒ©ãƒ³ã‚¯åˆ†ã‘</a> </li><li class> <a href="#å…·ä½“ä¾‹3-ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ä¿ã£ã¦æŒ¿å…¥">å…·ä½“ä¾‹3: ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ä¿ã£ã¦æŒ¿å…¥</a> </li><li class> <a href="#æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</a> </li><li class> <a href="#ã¾ã¨ã‚">ã¾ã¨ã‚</a> </li><li class> <a href="#references">References</a> </li> </ul> </details> </nav> <div class="article-content">  <h2 id="tldr">TL;DR<a aria-hidden="true" tabindex="-1" href="#tldr"><span class="icon icon-link"></span></a></h2>
<ul>
<li><code>bisect</code>ã¯ã‚½ãƒ¼ãƒˆæ¸ˆã¿é…åˆ—ã«å¯¾ã™ã‚‹äºŒåˆ†æ¢ç´¢ã‚’æ‰‹è»½ã«ä½¿ãˆã‚‹æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</li>
<li><code>bisect_left</code>ã¨<code>bisect_right</code>ã§æŒ¿å…¥ä½ç½®ã®åŸºæº–ã‚’ä½¿ã„åˆ†ã‘ã‚‹</li>
<li><code>insort</code>ã§ã‚½ãƒ¼ãƒˆã‚’ä¿ã£ãŸã¾ã¾ã®æŒ¿å…¥ã‚‚ç°¡å˜ã«ã§ãã‚‹</li>
</ul>
<h2 id="bisectã¨ã¯">bisectã¨ã¯<a aria-hidden="true" tabindex="-1" href="#bisectã¨ã¯"><span class="icon icon-link"></span></a></h2>
<p><code>bisect</code>ã¯ã‚½ãƒ¼ãƒˆæ¸ˆã¿ãƒªã‚¹ãƒˆã«å¯¾ã—ã¦äºŒåˆ†æ¢ç´¢ã‚’è¡Œã„ã€è¦ç´ ã‚’æŒ¿å…¥ã™ã¹ãä½ç½®ã‚’è¿”ã™ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€‚è‡ªå‰ã§äºŒåˆ†æ¢ç´¢ã‚’æ›¸ãæ‰‹é–“ã‚’çœã‘ã‚‹ã€‚åŸºæœ¬ã¯ä»¥ä¸‹ã®2ã¤ã‚’è¦šãˆã‚‹ã ã‘ã§ååˆ†ã€‚</p>
<ul>
<li><code>bisect_left(a, x)</code>ã¯xä»¥ä¸ŠãŒåˆã‚ã¦å‡ºç¾ã™ã‚‹ä½ç½®ã‚’è¿”ã™</li>
<li><code>bisect_right(a, x)</code>ã¯xã‚ˆã‚Šå¤§ãã„å€¤ãŒåˆã‚ã¦å‡ºç¾ã™ã‚‹ä½ç½®ã‚’è¿”ã™</li>
</ul>
<p>åŒã˜å€¤ãŒä¸¦ã¶å ´åˆã®é•ã„ã¯ã“ã“ã§æ±ºã¾ã‚‹ã€‚<code>a = [1, 3, 3, 6]</code>ãªã‚‰ã€<code>x = 3</code>ã®ã¨ãã«<code>bisect_left</code>ã¯1ã€<code>bisect_right</code>ã¯3ã«ãªã‚‹ã€‚</p>
<p>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ã—ã¦ã¯ã©ã¡ã‚‰ã‚‚äºŒåˆ†æ¢ç´¢ã§ã€æ¯”è¼ƒæ¡ä»¶ã ã‘ãŒé•ã†ã€‚<code>bisect_left</code>ã¯ã€Œ<code>a[mid] &#x3C; x</code>ãªã‚‰å³ã¸ã€ãã†ã§ãªã‘ã‚Œã°å·¦ã¸ã€ã‚’ç¹°ã‚Šè¿”ã—ã¦<code>a[i] >= x</code>ã¨ãªã‚‹æœ€å°ã®iã‚’æ¢ã™ã€‚<code>bisect_right</code>ã¯ã€Œ<code>a[mid] &#x3C;= x</code>ãªã‚‰å³ã¸ã€ãã†ã§ãªã‘ã‚Œã°å·¦ã¸ã€ã‚’ç¹°ã‚Šè¿”ã—ã¦<code>a[i] > x</code>ã¨ãªã‚‹æœ€å°ã®iã‚’æ¢ã™ã€‚</p>
<p><a href="https://github.com/python/cpython/blob/63cc1257db468a368d64c0b968d203a0f4c7303a/Lib/bisect.py">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</a>ã¯æ¬¡ã®é€šã‚Šã€‚</p>
<details>
<summary>bisect_leftã®å®Ÿè£…(æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª)</summary>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> bisect_left</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">a</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">x</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">lo</span><span style="color:#F92672">=</span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">hi</span><span style="color:#F92672">=</span><span style="color:#AE81FF">None</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">*</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">key</span><span style="color:#F92672">=</span><span style="color:#AE81FF">None</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#E6DB74">    """Return the index where to insert item x in list a, assuming a is sorted.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    The return value i is such that all e in a[:i] have e &#x3C; x, and all e in</span></span>
<span class="line"><span style="color:#E6DB74">    a[i:] have e >= x.  So if x already appears in the list, a.insert(i, x) will</span></span>
<span class="line"><span style="color:#E6DB74">    insert just before the leftmost x already there.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    Optional args lo (default 0) and hi (default len(a)) bound the</span></span>
<span class="line"><span style="color:#E6DB74">    slice of a to be searched.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    A custom key function can be supplied to customize the sort order.</span></span>
<span class="line"><span style="color:#E6DB74">    """</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        raise</span><span style="color:#66D9EF;font-style:italic"> ValueError</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'lo must be non-negative'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> hi </span><span style="color:#F92672">is</span><span style="color:#AE81FF"> None</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">        hi </span><span style="color:#F92672">=</span><span style="color:#66D9EF"> len</span><span style="color:#F8F8F2">(a)</span></span>
<span class="line"><span style="color:#88846F">    # Note, the comparison uses "&#x3C;" to match the</span></span>
<span class="line"><span style="color:#88846F">    # __lt__() logic in list.sort() and in heapq.</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> key </span><span style="color:#F92672">is</span><span style="color:#AE81FF"> None</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        while</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> hi:</span></span>
<span class="line"><span style="color:#F8F8F2">            mid </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> (lo </span><span style="color:#F92672">+</span><span style="color:#F8F8F2"> hi) </span><span style="color:#F92672">//</span><span style="color:#AE81FF"> 2</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> a[mid] </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> x:</span></span>
<span class="line"><span style="color:#F8F8F2">                lo </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span></span>
<span class="line"><span style="color:#F92672">            else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">                hi </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid</span></span>
<span class="line"><span style="color:#F92672">    else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        while</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> hi:</span></span>
<span class="line"><span style="color:#F8F8F2">            mid </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> (lo </span><span style="color:#F92672">+</span><span style="color:#F8F8F2"> hi) </span><span style="color:#F92672">//</span><span style="color:#AE81FF"> 2</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> key(a[mid]) </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> x:</span></span>
<span class="line"><span style="color:#F8F8F2">                lo </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span></span>
<span class="line"><span style="color:#F92672">            else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">                hi </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> lo</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># Overwrite above definitions with a fast C implementation</span></span>
<span class="line"><span style="color:#F92672">try</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">    from</span><span style="color:#F8F8F2"> _bisect </span><span style="color:#F92672">import</span><span style="color:#F92672"> *</span></span>
<span class="line"><span style="color:#F92672">except</span><span style="color:#66D9EF;font-style:italic"> ImportError</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">    pass</span></span></code></pre>
</details>
<details>
<summary>bisect_rightã®å®Ÿè£…(æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª)</summary>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> bisect_right</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">a</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">x</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">lo</span><span style="color:#F92672">=</span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">hi</span><span style="color:#F92672">=</span><span style="color:#AE81FF">None</span><span style="color:#F8F8F2">, </span><span style="color:#F92672">*</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">key</span><span style="color:#F92672">=</span><span style="color:#AE81FF">None</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#E6DB74">    """Return the index where to insert item x in list a, assuming a is sorted.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    The return value i is such that all e in a[:i] have e &#x3C;= x, and all e in</span></span>
<span class="line"><span style="color:#E6DB74">    a[i:] have e > x.  So if x already appears in the list, a.insert(i, x) will</span></span>
<span class="line"><span style="color:#E6DB74">    insert just after the rightmost x already there.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    Optional args lo (default 0) and hi (default len(a)) bound the</span></span>
<span class="line"><span style="color:#E6DB74">    slice of a to be searched.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E6DB74">    A custom key function can be supplied to customize the sort order.</span></span>
<span class="line"><span style="color:#E6DB74">    """</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#AE81FF"> 0</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        raise</span><span style="color:#66D9EF;font-style:italic"> ValueError</span><span style="color:#F8F8F2">(</span><span style="color:#E6DB74">'lo must be non-negative'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> hi </span><span style="color:#F92672">is</span><span style="color:#AE81FF"> None</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">        hi </span><span style="color:#F92672">=</span><span style="color:#66D9EF"> len</span><span style="color:#F8F8F2">(a)</span></span>
<span class="line"><span style="color:#88846F">    # Note, the comparison uses "&#x3C;" to match the</span></span>
<span class="line"><span style="color:#88846F">    # __lt__() logic in list.sort() and in heapq.</span></span>
<span class="line"><span style="color:#F92672">    if</span><span style="color:#F8F8F2"> key </span><span style="color:#F92672">is</span><span style="color:#AE81FF"> None</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        while</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> hi:</span></span>
<span class="line"><span style="color:#F8F8F2">            mid </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> (lo </span><span style="color:#F92672">+</span><span style="color:#F8F8F2"> hi) </span><span style="color:#F92672">//</span><span style="color:#AE81FF"> 2</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> x </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> a[mid]:</span></span>
<span class="line"><span style="color:#F8F8F2">                hi </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid</span></span>
<span class="line"><span style="color:#F92672">            else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">                lo </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span></span>
<span class="line"><span style="color:#F92672">    else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F92672">        while</span><span style="color:#F8F8F2"> lo </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> hi:</span></span>
<span class="line"><span style="color:#F8F8F2">            mid </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> (lo </span><span style="color:#F92672">+</span><span style="color:#F8F8F2"> hi) </span><span style="color:#F92672">//</span><span style="color:#AE81FF"> 2</span></span>
<span class="line"><span style="color:#F92672">            if</span><span style="color:#F8F8F2"> x </span><span style="color:#F92672">&#x3C;</span><span style="color:#F8F8F2"> key(a[mid]):</span></span>
<span class="line"><span style="color:#F8F8F2">                hi </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid</span></span>
<span class="line"><span style="color:#F92672">            else</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#F8F8F2">                lo </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> mid </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> lo</span></span></code></pre>
</details>
<h2 id="ä½¿ã„æ–¹ã®åŸºæœ¬">ä½¿ã„æ–¹ã®åŸºæœ¬<a aria-hidden="true" tabindex="-1" href="#ä½¿ã„æ–¹ã®åŸºæœ¬"><span class="icon icon-link"></span></a></h2>
<p>ã¾ãšã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒè¿”ã£ã¦ãã‚‹æŒ™å‹•ã‚’æŠŠæ¡ã™ã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> bisect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">a </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#AE81FF">1</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">6</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">9</span><span style="color:#F8F8F2">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># äºŒåˆ†æ¢ç´¢ã§æŒ¿å…¥ä½ç½®ã‚’æ¢ã™ã€‚</span></span>
<span class="line"><span style="color:#88846F"># bisect_left(a, x) ã¯åŒºé–“ã®ä¸­å¤®ã® index ã‚’ mid ã¨ã—ã¦ã€Œa[mid] &#x3C; x ãªã‚‰å³ã€</span></span>
<span class="line"><span style="color:#88846F"># ãã†ã§ãªã‘ã‚Œã°å·¦ã€ã‚’ç¹°ã‚Šè¿”ã—ã€a[i] >= x ã¨ãªã‚‹æœ€å°ã® i ã‚’è¿”ã™ã€‚</span></span>
<span class="line"><span style="color:#88846F"># bisect_right(a, x) ã¯åŒæ§˜ã«ã€Œa[mid] &#x3C;= x ãªã‚‰å³ã€ãã†ã§ãªã‘ã‚Œã°å·¦ã€ã‚’ç¹°ã‚Šè¿”ã—ã€</span></span>
<span class="line"><span style="color:#88846F"># a[i] > x ã¨ãªã‚‹æœ€å°ã® i ã‚’è¿”ã™ã€‚</span></span>
<span class="line"><span style="color:#88846F"># è¿”ã‚‹ i ã¯0å§‹ã¾ã‚Šã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã€a[i]ã®å‰ã«æŒ¿å…¥ã™ã‚‹ä½ç½®ã‚’è¡¨ã™</span></span>
<span class="line"><span style="color:#88846F"># ä¾‹ãˆã° i=1 ã¯ a[1] ã®å‰(ã¤ã¾ã‚Š a[0] ã¨ a[1] ã®é–“)ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># x=3 ã®ã¨ã</span></span>
<span class="line"><span style="color:#88846F"># index: 0  1  2  3  4</span></span>
<span class="line"><span style="color:#88846F"># value: 1  3  3  6  9</span></span>
<span class="line"><span style="color:#88846F"># left :    ^ (i=1, æœ€åˆã® 3 ã®å‰)</span></span>
<span class="line"><span style="color:#88846F"># right:          ^ (i=3, 2ã¤ã® 3 ã®å¾Œ)</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_left(a, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">))   </span><span style="color:#88846F"># æŒ¿å…¥ä½ç½®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(å·¦ç«¯): 1</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_right(a, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">))  </span><span style="color:#88846F"># æŒ¿å…¥ä½ç½®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(å³ç«¯): 3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F"># x=2 ã®ã¨ã</span></span>
<span class="line"><span style="color:#88846F"># index: 0  1  2  3  4</span></span>
<span class="line"><span style="color:#88846F"># value: 1  3  3  6  9</span></span>
<span class="line"><span style="color:#88846F"># left :    ^ (i=1, 1 ã¨æœ€åˆã® 3 ã®é–“)</span></span>
<span class="line"><span style="color:#88846F"># right:    ^ (i=1, 1 ã¨æœ€åˆã® 3 ã®é–“)</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_left(a, </span><span style="color:#AE81FF">2</span><span style="color:#F8F8F2">))   </span><span style="color:#88846F"># æŒ¿å…¥ä½ç½®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(å·¦ç«¯): 1</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_right(a, </span><span style="color:#AE81FF">2</span><span style="color:#F8F8F2">))  </span><span style="color:#88846F"># æŒ¿å…¥ä½ç½®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(å³ç«¯): 1</span></span></code></pre>
<p>ã“ã“ã§è¿”ã£ã¦ãã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€Œxã‚’æŒ¿å…¥ã—ãŸã¨ãã«æ˜‡é †ãŒä¿ãŸã‚Œã‚‹ä½ç½®ã€ã‚’æ„å‘³ã™ã‚‹ã€‚ä¾‹ãˆã°<code>a[1]</code>ã®å‰ã«æŒ¿å…¥ã™ã¹ããªã‚‰1ãŒè¿”ã‚‹ã€‚</p>
<p><code>3</code>ã¯ã™ã§ã«2ã¤ã‚ã‚‹ã®ã§ã€å·¦ç«¯ã®ä½ç½®ãŒ1ã€å³ç«¯ã®ä½ç½®ãŒ3ã«ãªã‚‹ã€‚<code>2</code>ã¯å­˜åœ¨ã—ãªã„ã®ã§ã€å…¥ã‚Œã‚‰ã‚Œã‚‹å ´æ‰€ã¯ã©ã¡ã‚‰ã‚‚1ã€‚</p>
<h2 id="ã‚³ãƒ¼ãƒŠãƒ¼ã‚±ãƒ¼ã‚¹-æœ€å°ã‚ˆã‚Šå°ã•ã„æœ€å¤§ã‚ˆã‚Šå¤§ãã„">ã‚³ãƒ¼ãƒŠãƒ¼ã‚±ãƒ¼ã‚¹: æœ€å°ã‚ˆã‚Šå°ã•ã„/æœ€å¤§ã‚ˆã‚Šå¤§ãã„<a aria-hidden="true" tabindex="-1" href="#ã‚³ãƒ¼ãƒŠãƒ¼ã‚±ãƒ¼ã‚¹-æœ€å°ã‚ˆã‚Šå°ã•ã„æœ€å¤§ã‚ˆã‚Šå¤§ãã„"><span class="icon icon-link"></span></a></h2>
<p>å¯¾è±¡ã®å€¤ãŒãƒªã‚¹ãƒˆã®æœ€å°ã‚ˆã‚Šå°ã•ã„å ´åˆã¯0ã€æœ€å¤§ã‚ˆã‚Šå¤§ãã„å ´åˆã¯<code>len(a)</code>ãŒè¿”ã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> bisect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">a </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#AE81FF">1</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">3</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">6</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">9</span><span style="color:#F8F8F2">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_left(a, </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">))   </span><span style="color:#88846F"># 0</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_right(a, </span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">))  </span><span style="color:#88846F"># 0</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_left(a, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">))  </span><span style="color:#88846F"># 5</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(bisect.bisect_right(a, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">)) </span><span style="color:#88846F"># 5</span></span></code></pre>
<p>ã©ã¡ã‚‰ã‚‚ã€ŒæŒ¿å…¥ã—ã¦æ˜‡é †ãŒä¿ãŸã‚Œã‚‹ä½ç½®ã€ãªã®ã§ã€å…ˆé ­ãªã‚‰0ã€æœ«å°¾ã®æ¬¡ãªã‚‰<code>len(a)</code>ã«ãªã‚‹ã€‚</p>
<h2 id="å…·ä½“ä¾‹1-å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’é«˜é€Ÿã«èª¿ã¹ã‚‹">å…·ä½“ä¾‹1: å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’é«˜é€Ÿã«èª¿ã¹ã‚‹<a aria-hidden="true" tabindex="-1" href="#å…·ä½“ä¾‹1-å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’é«˜é€Ÿã«èª¿ã¹ã‚‹"><span class="icon icon-link"></span></a></h2>
<p><code>bisect_left</code>ã§ä½ç½®ã‚’æ±‚ã‚ã€ãã“ãŒç¯„å›²å†…ã‹ã¤å€¤ãŒä¸€è‡´ã™ã‚Œã°å­˜åœ¨ã™ã‚‹ã¨åˆ¤å®šã§ãã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> bisect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> contains</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">a</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">x</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#F8F8F2">    i </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> bisect.bisect_left(a, x)</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> i </span><span style="color:#F92672">&#x3C;</span><span style="color:#66D9EF"> len</span><span style="color:#F8F8F2">(a) </span><span style="color:#F92672">and</span><span style="color:#F8F8F2"> a[i] </span><span style="color:#F92672">==</span><span style="color:#F8F8F2"> x</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">a </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#AE81FF">2</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">4</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">6</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">8</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">10</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(contains(a, </span><span style="color:#AE81FF">6</span><span style="color:#F8F8F2">))   </span><span style="color:#88846F"># True</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(contains(a, </span><span style="color:#AE81FF">7</span><span style="color:#F8F8F2">))   </span><span style="color:#88846F"># False</span></span></code></pre>
<h2 id="å…·ä½“ä¾‹2-ã‚¹ã‚³ã‚¢ã®ãƒ©ãƒ³ã‚¯åˆ†ã‘">å…·ä½“ä¾‹2: ã‚¹ã‚³ã‚¢ã®ãƒ©ãƒ³ã‚¯åˆ†ã‘<a aria-hidden="true" tabindex="-1" href="#å…·ä½“ä¾‹2-ã‚¹ã‚³ã‚¢ã®ãƒ©ãƒ³ã‚¯åˆ†ã‘"><span class="icon icon-link"></span></a></h2>
<p>é–¾å€¤ã®é…åˆ—ã‚’ç”¨æ„ã—ã¦ã€<code>bisect_right</code>ã§åŒºåˆ†ã‚’æ±‚ã‚ã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> bisect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> grade</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">score</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">thresholds</span><span style="color:#F8F8F2">, </span><span style="color:#FD971F;font-style:italic">labels</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#F8F8F2">    idx </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> bisect.bisect_right(thresholds, score)</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#F8F8F2"> labels[idx]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">thresholds </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#AE81FF">60</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">70</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">80</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">90</span><span style="color:#F8F8F2">]  </span><span style="color:#88846F"># 0-59, 60-69, 70-79, 80-89, 90-100</span></span>
<span class="line"><span style="color:#F8F8F2">labels </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#E6DB74">"F"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"D"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"C"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"B"</span><span style="color:#F8F8F2">, </span><span style="color:#E6DB74">"A"</span><span style="color:#F8F8F2">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(grade(</span><span style="color:#AE81FF">58</span><span style="color:#F8F8F2">, thresholds, labels))  </span><span style="color:#88846F"># F</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(grade(</span><span style="color:#AE81FF">70</span><span style="color:#F8F8F2">, thresholds, labels))  </span><span style="color:#88846F"># C</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(grade(</span><span style="color:#AE81FF">95</span><span style="color:#F8F8F2">, thresholds, labels))  </span><span style="color:#88846F"># A</span></span></code></pre>
<h2 id="å…·ä½“ä¾‹3-ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ä¿ã£ã¦æŒ¿å…¥">å…·ä½“ä¾‹3: ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ä¿ã£ã¦æŒ¿å…¥<a aria-hidden="true" tabindex="-1" href="#å…·ä½“ä¾‹3-ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ä¿ã£ã¦æŒ¿å…¥"><span class="icon icon-link"></span></a></h2>
<p><code>insort_left</code>ã‚„<code>insort_right</code>ã‚’ä½¿ã†ã¨ã€æŒ¿å…¥ä½ç½®ã®æ¢ç´¢ã¨æŒ¿å…¥ã‚’ã¾ã¨ã‚ã¦è¡Œãˆã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F92672">import</span><span style="color:#F8F8F2"> bisect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">a </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> [</span><span style="color:#AE81FF">1</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">4</span><span style="color:#F8F8F2">, </span><span style="color:#AE81FF">7</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#F8F8F2">bisect.insort(a, </span><span style="color:#AE81FF">5</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#66D9EF">print</span><span style="color:#F8F8F2">(a)  </span><span style="color:#88846F"># [1, 4, 5, 7]</span></span></code></pre>
<p>æ³¨æ„ç‚¹ã¨ã—ã¦ã€<code>insort</code>ã¯æŒ¿å…¥æ™‚ã«ãƒªã‚¹ãƒˆã®è¦ç´ ã‚’ãšã‚‰ã™ã®ã§ã€1å›ã‚ãŸã‚ŠO(n)ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ã€‚å¤§é‡æŒ¿å…¥ãŒã‚ã‚‹ãªã‚‰åˆ¥ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚‚æ¤œè¨ã—ãŸã„ã€‚</p>
<h2 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹<a aria-hidden="true" tabindex="-1" href="#æ³¨æ„ç‚¹"><span class="icon icon-link"></span></a></h2>
<p>æ¬¡ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«<code>bisect_right</code>ã¨<code>insort_right</code>ã¯ãã‚Œãã‚Œ<code>bisect</code>ã€<code>insort</code>ã¨ã„ã†åˆ¥åãŒä»˜ã„ã¦ã„ã‚‹ã€‚</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#88846F"># Create aliases</span></span>
<span class="line"><span style="color:#F8F8F2">bisect </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> bisect_right</span></span>
<span class="line"><span style="color:#F8F8F2">insort </span><span style="color:#F92672">=</span><span style="color:#F8F8F2"> insort_right</span></span></code></pre>
<p>ã¤ã¾ã‚Š<code>insort</code>ã¯ã€Œå³ç«¯ã«æŒ¿å…¥ã™ã‚‹<code>insort_right</code>ã®åˆ¥åã€ã§ã€åŒã˜å€¤ãŒã‚ã‚‹å ´åˆã¯å³å´ã«è¿½åŠ ã•ã‚Œã‚‹ã€‚</p>
<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚<a aria-hidden="true" tabindex="-1" href="#ã¾ã¨ã‚"><span class="icon icon-link"></span></a></h2>
<ul>
<li><code>bisect_left</code>ã¨<code>bisect_right</code>ã¯æŒ¿å…¥ä½ç½®ã®å¢ƒç•Œã‚’é¸ã¹ã‚‹</li>
<li>å­˜åœ¨åˆ¤å®šã‚„åŒºåˆ†ã®åˆ¤å®šã«ãã®ã¾ã¾ä½¿ãˆã‚‹</li>
<li><code>insort</code>ã§æ‰‹è»½ã«ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã‚’ç¶­æŒã§ãã‚‹ãŒã‚³ã‚¹ãƒˆã¯O(n)</li>
</ul>
<h2 id="references">References<a aria-hidden="true" tabindex="-1" href="#references"><span class="icon icon-link"></span></a></h2>
<ul>
<li><a href="https://docs.python.org/ja/3/library/bisect.html">https://docs.python.org/ja/3/library/bisect.html</a></li>
</ul>  </div> </article>  </main> <footer class="site-footer"> <p>&copy; 2026 diohabara. MAKE THE WORLD FUN AGAIN</p> </footer> <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script> </body> </html> <script type="module">function m(){document.querySelectorAll(".sidenote").forEach(e=>e.remove()),document.querySelectorAll(".footnotes").forEach(e=>{e.style.display=""});const r=document.querySelector("section.footnotes[data-footnotes]");if(!r)return;const p=r.querySelectorAll('li[id^="user-content-fn-"]');if(p.length===0)return;const f=document.querySelector(".article-content");if(!f)return;const v=window.innerWidth>=1120,g=new Map;p.forEach(e=>{const o=e.id.replace("user-content-fn-","");g.set(o,e)});const y=f.querySelectorAll("a[data-footnote-ref]"),E=[];if(y.forEach(e=>{const c=(e.getAttribute("href")||"").replace("#user-content-fn-",""),t=g.get(c);if(!t)return;const i=e.textContent?.trim()||"";let n=e.closest("p, li, blockquote, h1, h2, h3, h4, h5, h6, div, table, pre");if(!n||!f.contains(n))return;for(;n&&n.parentElement!==f;)if(n=n.parentElement,!n)return;const d=t.cloneNode(!0);d.querySelectorAll("a[data-footnote-backref]").forEach(h=>h.remove());const s=document.createElement("aside");s.className="sidenote",s.setAttribute("role","note"),s.setAttribute("data-footnote-id",c);const u=document.createElement("span");u.className="sidenote-number",u.textContent=i;const l=document.createElement("span");l.className="sidenote-content";const S=d.querySelectorAll("p");S.length>0?S.forEach((h,A)=>{A>0&&l.appendChild(document.createElement("br")),l.appendChild(document.createTextNode(h.textContent||""))}):l.textContent=d.textContent?.trim()||"",s.appendChild(u),s.appendChild(l);let w=n,a=n.nextElementSibling;for(;a&&a.classList.contains("sidenote");)w=a,a=a.nextElementSibling;w.insertAdjacentElement("afterend",s),E.push(s)}),v){let e=0;E.forEach(o=>{const c=o.getBoundingClientRect(),t=window.scrollY,i=c.top+t;if(i<e){const d=e-i;o.style.marginTop=`${d}px`}e=o.getBoundingClientRect().bottom+t+8})}r.style.display="none",document.querySelectorAll("a[data-footnote-ref]").forEach(e=>{const c=(e.getAttribute("href")||"").replace("#user-content-fn-",""),t=document.querySelector(`.sidenote[data-footnote-id="${c}"]`);t&&(e.addEventListener("mouseenter",()=>t.classList.add("sidenote-highlight")),e.addEventListener("mouseleave",()=>t.classList.remove("sidenote-highlight")),e.addEventListener("focus",()=>t.classList.add("sidenote-highlight")),e.addEventListener("blur",()=>t.classList.remove("sidenote-highlight")),e.addEventListener("click",i=>{i.preventDefault(),t.classList.add("sidenote-highlight"),setTimeout(()=>t.classList.remove("sidenote-highlight"),1500)}))})}m();document.addEventListener("astro:after-swap",m);let b=window.innerWidth>=1120;window.addEventListener("resize",()=>{const r=window.innerWidth>=1120;r!==b&&(b=r,m())});</script>