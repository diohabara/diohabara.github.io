<!DOCTYPE html><html lang="ja"> <head><script>
      (function() {
        var stored = localStorage.getItem('theme');
        var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (stored === 'dark' || (!stored && prefersDark)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>picoCTF 2021: Transformation | barabara diary</title><meta name="description" content="MAKE THE WORLD FUN AGAIN"><meta name="keywords" content="blog, diohabara, CTF, Reverse Engineering"><meta property="og:url" content="https://diohabara.github.io/blog/picoctf2021-transformation/"><meta property="og:type" content="article"><meta property="og:title" content="picoCTF 2021: Transformation | barabara diary"><meta property="og:description" content="MAKE THE WORLD FUN AGAIN"><meta property="og:image" content="https://diohabara.github.io/img/avatar.jpg"><meta property="article:published_time" content="2023-08-09T19:11:01.000Z"><meta property="article:modified_time" content="2023-08-09T19:11:01.000Z"><meta property="article:author" content="diohabara"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse Engineering"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="picoCTF 2021: Transformation | barabara diary"><meta name="twitter:description" content="MAKE THE WORLD FUN AGAIN"><meta name="twitter:site" content="@diohabara"><meta name="twitter:creator" content="@diohabara"><meta name="twitter:image" content="https://diohabara.github.io/img/avatar.jpg"><link rel="canonical" href="https://diohabara.github.io/blog/picoctf2021-transformation/"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" title="barabara diary" href="/rss.xml"><script async src="https://www.googletagmanager.com/gtag/js?id=G-JC4F65F0RT"></script><script>(function(){const gaId = "G-JC4F65F0RT";

      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"picoCTF 2021: Transformation","name":"picoCTF 2021: Transformation","url":"https://diohabara.github.io/blog/picoctf2021-transformation/","description":"MAKE THE WORLD FUN AGAIN","keywords":"CTF, Reverse Engineering","wordCount":139,"datePublished":"2023-08-09T19:11:01.000Z","dateModified":"2023-08-09T19:11:01.000Z","author":{"@type":"Person","name":"diohabara","url":"https://diohabara.github.io/"},"publisher":{"@type":"Person","name":"diohabara","logo":{"@type":"ImageObject","url":"https://diohabara.github.io/img/avatar.jpg"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diohabara.github.io/blog/picoctf2021-transformation/"},"inLanguage":"ja"}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://diohabara.github.io/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://diohabara.github.io/blog/"},{"@type":"ListItem","position":3,"name":"picoCTF 2021: Transformation","item":"https://diohabara.github.io/blog/picoctf2021-transformation/"}]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"diohabara","url":"https://diohabara.github.io/","description":"MAKE THE WORLD FUN AGAIN","sameAs":["https://twitter.com/diohabara"]}</script><link rel="stylesheet" href="/_astro/_slug_.DV60zqMk.css"></head> <body> <a class="skip-link" href="#content">Skip to content</a> <header class="site-header"> <h1><a href="/">barabara diary</a></h1> <nav class="site-nav"> <a href="/blog/"> Blog </a><a href="/compensation/"> Compensation </a><a href="/tags/"> Tags </a><a href="https://github.com/diohabara/" target="_blank" rel="noopener noreferrer"> GitHub </a><a href="/search/"> Search </a><a href="/rss.xml"> RSS </a> <button class="dark-toggle" id="dark-toggle" aria-label="Toggle dark mode"> <span id="theme-icon">üåô</span> </button> </nav> </header> <script type="module">function s(){const n=document.getElementById("dark-toggle"),t=document.getElementById("theme-icon");if(!n||!t)return;const e=document.documentElement,a=e.classList.contains("dark");t.textContent=a?"‚òÄÔ∏è":"üåô",requestAnimationFrame(()=>{e.classList.add("transitions-ready")}),n.addEventListener("click",()=>{const o=e.classList.toggle("dark");localStorage.setItem("theme",o?"dark":"light"),t.textContent=o?"‚òÄÔ∏è":"üåô"})}s();document.addEventListener("astro:after-swap",s);</script> <main id="content">  <article class="has-sidenotes"> <header class="article-header"> <h1>picoCTF 2021: Transformation</h1> <div class="post-meta"> <time datetime="2023-08-09T19:11:01.000Z">2023/08/09</time> <span class="post-tags"> <a class="tag" href="/tags/CTF/">CTF</a><a class="tag" href="/tags/Reverse Engineering/">Reverse Engineering</a> </span> </div> </header> <nav class="toc"> <details open> <summary>ÁõÆÊ¨°</summary> <ul> <li class> <a href="#solution">Solution</a> </li><li class> <a href="#acknowledgement">Acknowledgement</a> </li><li class> <a href="#references">References</a> </li> </ul> </details> </nav> <div class="article-content">  <ul>
<li><a href="#solution">Solution</a></li>
<li><a href="#acknowledgement">Acknowledgement</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="solution">Solution<a aria-hidden="true" tabindex="-1" href="#solution"><span class="icon icon-link"></span></a></h2>
<p>You will be given the following file, <code>enc</code>.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#A6E22E">$</span><span style="color:#E6DB74"> bat</span><span style="color:#E6DB74"> resources/enc</span><span style="color:#AE81FF"> -p</span></span>
<span class="line"><span style="color:#A6E22E">ÁÅ©ÊçØ‰çî‰ôª„Ñ∂ÂΩ¢Ê•¥ÁçüÊ•ÆÁç¥„å¥ÊëüÊΩ¶Âº∏ÂΩ§„î≤Êå∂Êàπ„çΩ</span></span></code></pre>
<p>The problem description says</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="markdown"><code><span class="line"><span style="color:#F8F8F2">I wonder what this really is...</span></span>
<span class="line"><span style="color:#F8F8F2">''.join([chr((ord(flag[</span><span style="color:#AE81FF">i</span><span style="color:#F8F8F2">]) &#x3C;&#x3C; 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])</span></span></code></pre>
<p>The <code>enc</code> file should contain the encrypted flag. The flag is encrypted by the following algorithm.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> encrypt</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">flag</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2">.join([</span><span style="color:#66D9EF">chr</span><span style="color:#F8F8F2">((</span><span style="color:#66D9EF">ord</span><span style="color:#F8F8F2">(flag[i]) </span><span style="color:#F92672">&#x3C;&#x3C;</span><span style="color:#AE81FF"> 8</span><span style="color:#F8F8F2">) </span><span style="color:#F92672">+</span><span style="color:#66D9EF"> ord</span><span style="color:#F8F8F2">(flag[i </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span><span style="color:#F8F8F2">])) </span><span style="color:#F92672">for</span><span style="color:#F8F8F2"> i </span><span style="color:#F92672">in</span><span style="color:#66D9EF"> range</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF">len</span><span style="color:#F8F8F2">(flag), </span><span style="color:#AE81FF">2</span><span style="color:#F8F8F2">)])</span></span></code></pre>
<p>Thus, we need to decrypt the flag. The following script decrypts the flag.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#66D9EF;font-style:italic">def</span><span style="color:#A6E22E"> decrypt</span><span style="color:#F8F8F2">(</span><span style="color:#FD971F;font-style:italic">flag</span><span style="color:#F8F8F2">):</span></span>
<span class="line"><span style="color:#F92672">    return</span><span style="color:#E6DB74"> ""</span><span style="color:#F8F8F2">.join([</span><span style="color:#66D9EF">chr</span><span style="color:#F8F8F2">((</span><span style="color:#66D9EF">ord</span><span style="color:#F8F8F2">(flag[i]) </span><span style="color:#F92672">>></span><span style="color:#AE81FF"> 8</span><span style="color:#F8F8F2">) </span><span style="color:#F92672">+</span><span style="color:#66D9EF"> ord</span><span style="color:#F8F8F2">(flag[i </span><span style="color:#F92672">+</span><span style="color:#AE81FF"> 1</span><span style="color:#F8F8F2">])) </span><span style="color:#F92672">for</span><span style="color:#F8F8F2"> i </span><span style="color:#F92672">in</span><span style="color:#66D9EF"> range</span><span style="color:#F8F8F2">(</span><span style="color:#AE81FF">0</span><span style="color:#F8F8F2">, </span><span style="color:#66D9EF">len</span><span style="color:#F8F8F2">(flag), </span><span style="color:#AE81FF">2</span><span style="color:#F8F8F2">)])</span></span></code></pre>
<p>Yeah, we‚Äôve got the flag.</p>
<pre class="astro-code monokai" style="background-color:#272822;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="txt"><code><span class="line"><span>$ python scripts/transformation.py</span></span>
<span class="line"><span>picoCTF{16_bits_inst34d_of_8_d52c6b93}</span></span></code></pre>
<h2 id="acknowledgement">Acknowledgement<a aria-hidden="true" tabindex="-1" href="#acknowledgement"><span class="icon icon-link"></span></a></h2>
<p>Thank you, CMU security and privacy experts, for creating this challenge.</p>
<h2 id="references">References<a aria-hidden="true" tabindex="-1" href="#references"><span class="icon icon-link"></span></a></h2>  </div> </article>  </main> <footer class="site-footer"> <p>&copy; 2026 diohabara. MAKE THE WORLD FUN AGAIN</p> </footer> <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script> </body> </html> <script type="module">function m(){document.querySelectorAll(".sidenote").forEach(e=>e.remove()),document.querySelectorAll(".footnotes").forEach(e=>{e.style.display=""});const r=document.querySelector("section.footnotes[data-footnotes]");if(!r)return;const p=r.querySelectorAll('li[id^="user-content-fn-"]');if(p.length===0)return;const f=document.querySelector(".article-content");if(!f)return;const v=window.innerWidth>=1120,g=new Map;p.forEach(e=>{const o=e.id.replace("user-content-fn-","");g.set(o,e)});const y=f.querySelectorAll("a[data-footnote-ref]"),E=[];if(y.forEach(e=>{const c=(e.getAttribute("href")||"").replace("#user-content-fn-",""),t=g.get(c);if(!t)return;const i=e.textContent?.trim()||"";let n=e.closest("p, li, blockquote, h1, h2, h3, h4, h5, h6, div, table, pre");if(!n||!f.contains(n))return;for(;n&&n.parentElement!==f;)if(n=n.parentElement,!n)return;const d=t.cloneNode(!0);d.querySelectorAll("a[data-footnote-backref]").forEach(h=>h.remove());const s=document.createElement("aside");s.className="sidenote",s.setAttribute("role","note"),s.setAttribute("data-footnote-id",c);const u=document.createElement("span");u.className="sidenote-number",u.textContent=i;const l=document.createElement("span");l.className="sidenote-content";const S=d.querySelectorAll("p");S.length>0?S.forEach((h,A)=>{A>0&&l.appendChild(document.createElement("br")),l.appendChild(document.createTextNode(h.textContent||""))}):l.textContent=d.textContent?.trim()||"",s.appendChild(u),s.appendChild(l);let w=n,a=n.nextElementSibling;for(;a&&a.classList.contains("sidenote");)w=a,a=a.nextElementSibling;w.insertAdjacentElement("afterend",s),E.push(s)}),v){let e=0;E.forEach(o=>{const c=o.getBoundingClientRect(),t=window.scrollY,i=c.top+t;if(i<e){const d=e-i;o.style.marginTop=`${d}px`}e=o.getBoundingClientRect().bottom+t+8})}r.style.display="none",document.querySelectorAll("a[data-footnote-ref]").forEach(e=>{const c=(e.getAttribute("href")||"").replace("#user-content-fn-",""),t=document.querySelector(`.sidenote[data-footnote-id="${c}"]`);t&&(e.addEventListener("mouseenter",()=>t.classList.add("sidenote-highlight")),e.addEventListener("mouseleave",()=>t.classList.remove("sidenote-highlight")),e.addEventListener("focus",()=>t.classList.add("sidenote-highlight")),e.addEventListener("blur",()=>t.classList.remove("sidenote-highlight")),e.addEventListener("click",i=>{i.preventDefault(),t.classList.add("sidenote-highlight"),setTimeout(()=>t.classList.remove("sidenote-highlight"),1500)}))})}m();document.addEventListener("astro:after-swap",m);let b=window.innerWidth>=1120;window.addEventListener("resize",()=>{const r=window.innerWidth>=1120;r!==b&&(b=r,m())});</script>