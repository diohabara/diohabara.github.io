<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D;--font-size:17.5px}</style><title>CTF初心者がNSA Codebreakerに参加した感想</title><meta name=description content=" 3 行まとめ NSA Codebreaker Challenge とは？ なぜ参加をしたのか？ 解けた問題の簡単な解説 Task 0 Task A1 Task A2 Task B1 Task B2 Task 5 Task 6 総括 謝辞 NSA Codebreaker Challenge 2022のバッジ 3 行まと …"><meta name=keywords content='blog,diohabara,hugo,ctf,nsa cbc,japanese'><meta property="og:url" content="https://diohabara.github.io/blog/nsa-cbc-2022/"><meta property="og:type" content="article"><meta property="og:title" content="CTF初心者がNSA Codebreakerに参加した感想"><meta property="og:description" content=" 3 行まとめ NSA Codebreaker Challenge とは？ なぜ参加をしたのか？ 解けた問題の簡単な解説 Task 0 Task A1 Task A2 Task B1 Task B2 Task 5 Task 6 総括 謝辞 NSA Codebreaker Challenge 2022のバッジ 3 行まと …"><meta property="og:image" content="https://diohabara.github.io/images/avatar.jpg"><meta property="og:image:secure_url" content="https://diohabara.github.io/images/avatar.jpg"><meta property="article:published_time" content="2022-12-27T01:16:36+09:00"><meta property="article:modified_time" content="2022-12-27T01:16:36+09:00"><meta property="article:author" content="diohabara"><meta property="article:tag" content="ctf"><meta property="article:tag" content="nsa cbc"><meta property="article:tag" content="japanese"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="CTF初心者がNSA Codebreakerに参加した感想"><meta name=twitter:description content=" 3 行まとめ NSA Codebreaker Challenge とは？ なぜ参加をしたのか？ 解けた問題の簡単な解説 Task 0 Task A1 Task A2 Task B1 Task B2 Task 5 Task 6 総括 謝辞 NSA Codebreaker Challenge 2022のバッジ 3 行まと …"><meta name=twitter:site content="@diohabara"><meta name=twitter:creator content="@diohabara"><meta property="twitter:domain" content="https://diohabara.github.io/blog/nsa-cbc-2022/"><meta property="twitter:url" content="https://diohabara.github.io/blog/nsa-cbc-2022/"><meta name=twitter:image content="https://diohabara.github.io/images/avatar.jpg"><link rel=canonical href=https://diohabara.github.io/blog/nsa-cbc-2022/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.7136b4abac7b277aba8bc933917f4602d39a5c44f5590be687244bc86ef4f162.js integrity="sha256-cTa0q6x7J3q6i8kzkX9GAtOaXET1WQvmhyRLyG708WI="></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"diohabara","url":"https://diohabara.github.io/"},"dateModified":"2022-12-27T01:16:36+09:00","datePublished":"2022-12-27T01:16:36+09:00","description":" 3 行まとめ NSA Codebreaker Challenge とは？ なぜ参加をしたのか？ 解けた問題の簡単な解説 Task 0 Task A1 Task A2 Task B1 Task B2 Task 5 Task 6 総括 謝辞 NSA Codebreaker Challenge 2022のバッジ 3 行まと …","headline":"CTF初心者がNSA Codebreakerに参加した感想","image":{"@type":"ImageObject","url":"https://diohabara.github.io/images/avatar.jpg"},"inLanguage":"ja","keywords":"ctf, nsa cbc, japanese","mainEntityOfPage":{"@id":"https://diohabara.github.io/blog/nsa-cbc-2022/","@type":"WebPage"},"name":"CTF初心者がNSA Codebreakerに参加した感想","publisher":{"@type":"Person","logo":{"@type":"ImageObject","url":"https://diohabara.github.io/images/avatar.jpg"},"name":"diohabara"},"url":"https://diohabara.github.io/blog/nsa-cbc-2022/","wordCount":215}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://diohabara.github.io/","name":"Home","position":1},{"@type":"ListItem","item":"https://diohabara.github.io/blog/","name":"ブログ","position":2},{"@type":"ListItem","item":"https://diohabara.github.io/blog/nsa-cbc-2022/","name":"CTF初心者がNSA Codebreakerに参加した感想","position":3}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Person","description":"MAKE THE WORLD FUN AGAIN","name":"diohabara","sameAs":["https://twitter.com/diohabara"],"url":"https://diohabara.github.io/"}</script><link rel=stylesheet href=/css/custom.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-JC4F65F0RT"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JC4F65F0RT")</script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://diohabara.github.io/><img src=/images/avatar.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://diohabara.github.io/>barabara diary</a></div><div class=nav-links><div class=nav-link><a href=https://diohabara.github.io/blog/ aria-label=blog><span data-feather=globe></span> blog</a></div><div class=nav-link><a href=https://diohabara.github.io/compensation/ aria-label=compensation><span data-feather=dollar-sign></span> Compensation</a></div><div class=nav-link><a href=https://diohabara.github.io/tags/ aria-label=tags><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/diohabara/ aria-label=github><span data-feather=github></span></a></div><div class=nav-link><a href=https://diohabara.github.io/search/ aria-label=search><span data-feather=search></span> Search</a></div><div class=nav-link><a href=https://diohabara.github.io/index.xml aria-label=rss><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a aria-hidden=true role=switch><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a aria-checked=false aria-labelledby=hamburger-menu-toggle id=hamburger-menu-toggle-target role=switch><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://diohabara.github.io/blog/><span data-feather=globe></span> blog</a></li><li class=nav-item><a href=https://diohabara.github.io/compensation/><span data-feather=dollar-sign></span> Compensation</a></li><li class=nav-item><a href=https://diohabara.github.io/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/diohabara/><span data-feather=github></span></a></li><li class=nav-item><a href=https://diohabara.github.io/search/><span data-feather=search></span> Search</a></li><li class=nav-item><a href=https://diohabara.github.io/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a role=switch><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>CTF初心者がNSA Codebreakerに参加した感想</h1><small role=doc-subtitle></small><p class=post-date>December 27, 2022</p><ul class=post-tags><li class=post-tag><a href=https://diohabara.github.io/tags/ctf>ctf</a></li><li class=post-tag><a href=https://diohabara.github.io/tags/nsa-cbc>nsa cbc</a></li><li class=post-tag><a href=https://diohabara.github.io/tags/japanese>japanese</a></li></ul></div><div class=post-content><ul><li><a href=#3-%E8%A1%8C%E3%81%BE%E3%81%A8%E3%82%81>3 行まとめ</a></li><li><a href=#nsa-codebreaker-challenge-%E3%81%A8%E3%81%AF>NSA Codebreaker Challenge とは？</a></li><li><a href=#%E3%81%AA%E3%81%9C%E5%8F%82%E5%8A%A0%E3%82%92%E3%81%97%E3%81%9F%E3%81%AE%E3%81%8B>なぜ参加をしたのか？</a></li><li><a href=#%E8%A7%A3%E3%81%91%E3%81%9F%E5%95%8F%E9%A1%8C%E3%81%AE%E7%B0%A1%E5%8D%98%E3%81%AA%E8%A7%A3%E8%AA%AC>解けた問題の簡単な解説</a><ul><li><a href=#task-0>Task 0</a></li><li><a href=#task-a1>Task A1</a></li><li><a href=#task-a2>Task A2</a></li><li><a href=#task-b1>Task B1</a></li><li><a href=#task-b2>Task B2</a></li><li><a href=#task-5>Task 5</a></li><li><a href=#task-6>Task 6</a></li><li><a href=#%E7%B7%8F%E6%8B%AC>総括</a></li></ul></li><li><a href=#%E8%AC%9D%E8%BE%9E>謝辞</a></li></ul><p><figure class=markdown-image><img src=/images/badgea1.png alt=badge><figcaption>NSA Codebreaker Challenge 2022のバッジ</figcaption></figure></p><h2 id=3-行まとめ>3 行まとめ <a href=#3-%e8%a1%8c%e3%81%be%e3%81%a8%e3%82%81>#</a></h2><ol><li>NSA はアメリカの大学(院)生を対象に CTF コンテストを開いている</li><li>大学院の授業の一環で参加した</li><li>今回自分が解いた問題を簡単に解説</li></ol><h2 id=nsa-codebreaker-challenge-とは>NSA Codebreaker Challenge とは？ <a href=#nsa-codebreaker-challenge-%e3%81%a8%e3%81%af>#</a></h2><p>アメリカと聞いたら何を思い浮かべるでしょうか？やはり NSA、CIA、FBI のような諜報機関ですよね。その中でも NSA は大規模な個人情報収集をしているとスノーデンが暴露したことで有名ですね。そんなゲキヤバストーカー集団 NSA が開いた CTF コンテストに CTF 初心者であるワテクシ＝漏れが参加した記録です。</p><p>???「&ldquo;NSA Codebreaker Challenge"よ&mldr;これは名前。」</p><p>URL: <a href=https://nsa-codebreaker.org/home>https://nsa-codebreaker.org/home</a></p><p>このコンテストは学生にセキュリティ関連の問題を解く機会とされています。同時に学生が 10 問中 9 問以上解くと NSA から採用の連絡が来ることも告げられており、採用活動の一環でもあるようです。</p><p>以下はその原文です。</p><blockquote><p>The NSA Codebreaker Challenge provides students with a hands-on opportunity to develop their reverse-engineering / low-level code analysis skills while working on a realistic problem set centered around the NSA&rsquo;s mission.
While the challenge is intended for students, professors are encouraged to participate as well. Furthermore, the site was designed to make it easy for those professors interested in incorporating the challenge into their courses to do so (see the additional FAQ entries below.)</p></blockquote><p>実際にはバイナリ解析のような問題ばかりではなく、Web に関する知識など広くセキュリティに関連する知識を要求されます。</p><h2 id=なぜ参加をしたのか>なぜ参加をしたのか？ <a href=#%e3%81%aa%e3%81%9c%e5%8f%82%e5%8a%a0%e3%82%92%e3%81%97%e3%81%9f%e3%81%ae%e3%81%8b>#</a></h2><p>今回僕が参加したのは授業の一環です。先学期取ったバイナリ解析の授業で参加が要求され、成績の 20%を占めていました。
授業ではバイナリ解析については扱ったがその他の知識は完全にググった程度だったので初心者でもある程度は解けるように設計されているらしい。</p><h2 id=解けた問題の簡単な解説>解けた問題の簡単な解説 <a href=#%e8%a7%a3%e3%81%91%e3%81%9f%e5%95%8f%e9%a1%8c%e3%81%ae%e7%b0%a1%e5%8d%98%e3%81%aa%e8%a7%a3%e8%aa%ac>#</a></h2><p>では、ようやく NSA の作った問題をざっくり紹介しながら解説していきます。</p><p>このコンテストには FBI の捜査員としてランサムウェアの被害を受けた会社と連携してその犯人を探すという設定があり、設定に従って問題を解いていく。</p><h3 id=task-0>Task 0 <a href=#task-0>#</a></h3><p>Discord に参加すればフラグがもらえます。こういうタスクってほぼアクティブな参加者数を特定するためだけに使われていますよね。</p><h3 id=task-a1>Task A1 <a href=#task-a1>#</a></h3><p>侵入された会社の VPN のログから怪しいユーザーを割り出すというもの。同じ時間に 2 つの IP アドレスからアクセスしているユーザーが怪しいのでそのユーザー名がフラグです。エクセルなどでログをソートすれば見つかるはずです。</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/a1.ipynb>詳しい write-up</a></p><h3 id=task-a2>Task A2 <a href=#task-a2>#</a></h3><p>次は<code>.pcap</code>ファイルと<code>.pem</code>ファイルの入ったフォルダのデータが与えられるので、Wireshark を使って TLS セッションを復号しユーザー名っぽいものを探します。適当に入力したものが答えでした()</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/a2.ipynb>詳しい write-up</a></p><h3 id=task-b1>Task B1 <a href=#task-b1>#</a></h3><p>ランサムサイトから関連するサイトを見つけるという問題で、ブラウザの<code>Developer Tools</code>の<code>Network</code>からヘッダーにある別のドメインのサイトを見つけました。</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/b1.ipynb>詳しい write-up</a></p><h3 id=task-b2>Task B2 <a href=#task-b2>#</a></h3><p>今度は<a href=#task-b1>Task B1</a>で見つけたサイトから「ログインページを見つけろ」という問題です。<a href=https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/common.txt>このリスト</a>を使ってブルートフォースをし、<code>.git</code>が露出していたので<a href=https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh>gitdumper.sh</a>というツールを使いソースコード全体を取り出しソースコードからログインページを割り出しました。</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/b2.ipynb>詳しい write-up</a></p><h3 id=task-5>Task 5 <a href=#task-5>#</a></h3><p>この問題はようやくバイナリ解析します。<code>ssh-agent</code>と<code>core</code>と暗号化されたデータ<code>data.enc</code>が与えられるので、<code>gdb</code>を使って起動します。<code>core</code>があるので、メモリ上にあったデータを見ることができます。そして、その中から openssl のハッシュの元となるデータを見つけ、再度生成します。生成した<code>.pem</code>ファイルを使って<code>data.enc</code>を複合すれば答えが得られました。</p><p>この問題が一番難しいと同時に面白かったです。</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/task5.ipynb>詳しい write-up</a></p><h3 id=task-6>Task 6 <a href=#task-6>#</a></h3><p>この問題は一番簡単でした。<a href=#task-5>Task 5</a>の答えは JWT のトークンであり、JWT から元となるデータを手に入れ、パスワードを<a href=#task-b2>Task B2</a>で手に入れたソースコードから見つけそれらを組み合わせることで新しく JWT のトークンを生成します。それが答えです。</p><p><a href=https://github.com/diohabara/nsa-codebreaker-challenge2022/blob/main/task6.ipynb>詳しい write-up</a></p><h3 id=総括>総括 <a href=#%e7%b7%8f%e6%8b%ac>#</a></h3><p>write-up を書くとなぜ手こずっていたのかよくわからなくなりますね。あと、投稿完全に遅れてすみません&mldr;</p><h2 id=謝辞>謝辞 <a href=#%e8%ac%9d%e8%be%9e>#</a></h2><p>授業を提供し、このコンテストに参加するきっかけをくれた教授に感謝。
コンテストを開催してくれた NSA にも感謝。</p></div><div class=prev-next></div></div></main><footer class=footer><span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/gokarna-theme/gokarna-hugo>Gokarna</a></span></footer><script src=/js/image-lazy-load.js></script></body></html>